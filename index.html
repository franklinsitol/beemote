<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Postagens com Iframes</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    form {
      margin-bottom: 20px;
    }
    .iframe-container {
      margin-bottom: 20px;
    }
    iframe {
      width: 100%;
      height: 200px;
      border: 1px solid #ddd;
    }
  </style>
</head>
<body>
  <h1>Adicionar Postagem</h1>
  
  <form id="postForm">
    <label for="postData">Digite o conteúdo da postagem:</label><br>
    <textarea id="postData" name="postData" rows="4" cols="50" required></textarea><br><br>
    <button type="submit">Enviar Postagem</button>
  </form>
  
  <h2>Postagens</h2>
  <div id="iframesContainer"></div>

  <script>
    // Função para criar um iframe com o conteúdo do post
    function createIframe(content) {
      const iframe = document.createElement('iframe');
      const container = document.createElement('div');
      container.classList.add('iframe-container');

      // Carrega o conteúdo embutido no iframe como um documento HTML
      const iframeContent = `
        <html>
          <body>
            <div style="padding: 20px; font-family: Arial, sans-serif;">
              <h2>Postagem:</h2>
              <p>${content}</p>
            </div>
          </body>
        </html>
      `;

      // Escreve no documento do iframe
      iframe.srcdoc = iframeContent;

      container.appendChild(iframe);
      document.getElementById('iframesContainer').appendChild(container);
    }

    // Função para carregar postagens a partir da hash na URL
    function loadPostsFromURL() {
      const hash = window.location.hash.substring(1); // Remove o '#' do início
      if (hash) {
        const posts = JSON.parse(decodeURIComponent(hash));
        posts.forEach(post => {
          createIframe(post);
        });
      }
    }

    // Função para adicionar uma nova postagem
    function addPost(event) {
      event.preventDefault(); // Evita o reload da página
      const postData = document.getElementById('postData').value;

      // Pega as postagens existentes da URL ou cria um array vazio
      const hash = window.location.hash.substring(1);
      const posts = hash ? JSON.parse(decodeURIComponent(hash)) : [];

      // Adiciona a nova postagem
      posts.push(postData);

      // Atualiza a hash da URL com as postagens codificadas
      const encodedPosts = encodeURIComponent(JSON.stringify(posts));
      window.location.hash = encodedPosts;

      // Cria um novo iframe com o conteúdo da postagem
      createIframe(postData);

      // Limpa o campo de texto
      document.getElementById('postData').value = '';
    }

    // Associa a função de adicionar post ao evento de submit do formulário
    document.getElementById('postForm').addEventListener('submit', addPost);

    // Carrega as postagens existentes ao carregar a página
    loadPostsFromURL();
  </script>
</body>
</html>
